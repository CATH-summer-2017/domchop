
<html>


<head><title>{{title}}</title></head>

<body>

<style>
</style>

{% include "./style.html" %}
<script src="https://mpld3.github.io/js/d3.v3.min.js"></script>
<script src="https://mpld3.github.io/js/mpld3.v0.2.js"></script>
{% autoescape off %}
{# <p class="lead">{{greet}}</p> #}
<p><b>{{greet.0}}
{# <button type="button" class="btn btn-info" data-toggle="popover" title="Doped_CATH" data-content=" #}
{# {{greet.1}}">What is this?</button> #}
<button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal">What is this?</button>
</b></p>


<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">What is this?</h4>
      </div>
      <div class="modal-body">
        <p>{{greet.1}}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>
  {% endautoescape %}


<div id="fig_1"></div>

<script>

var fig_json2 ='{"axes": [{"xlim": [0.0, 500.0], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Domain length (aa)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [0.5, -0.095057720057720063], "rotation": -0.0, "id": "el1178139943937602320"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number nb-interaction pairs", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [-0.21904121863799283, 0.5], "rotation": -90.0, "id": "el1178139943937737168"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "    y  = 831.131 * x + 7061.493     R_squared=0.963 ", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 12.0, "position": [0.5, 1.027056277056277], "rotation": -0.0, "id": "el1178139943937407760"}, {"v_baseline": "auto", "h_anchor": "start", "color": "#000000", "text": "linear regression fit", "coordinates": "axes", "zorder": 1000003.0, "alpha": 1, "fontsize": 10.0, "position": [0.52338709677419348, 0.92370129870129891], "rotation": -0.0, "id": "el1178139943936821456"}, {"v_baseline": "auto", "h_anchor": "start", "color": "#000000", "text": "outlier num = 0", "coordinates": "axes", "zorder": 1000003.0, "alpha": 1, "fontsize": 10.0, "position": [0.52338709677419348, 0.85569985569985563], "rotation": -0.0, "id": "el1178139943936991440"}], "zoomable": true, "images": [], "xdomain": [0.0, 500.0], "ylim": [0.0, 500000.0], "paths": [{"edgecolor": "#CCCCCC", "facecolor": "#FFFFFF", "edgewidth": 1.0, "pathcodes": ["M", "L", "S", "L", "S", "L", "S", "L", "S", "Z"], "yindex": 1, "coordinates": "axes", "dasharray": "none", "zorder": 1000000.0, "alpha": 0.8, "xindex": 0, "data": "data06", "id": "el1178139943936820368"}], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "bottom", "nticks": 6, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "left", "nticks": 6, "tickvalues": null}], "lines": [{"drawstyle": "default", "color": "#007F00", "yindex": 1, "coordinates": "data", "dasharray": "5.6,2.4", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el1178139943936819920"}, {"drawstyle": "default", "color": "#007F00", "yindex": 1, "coordinates": "axes", "dasharray": "5.6,2.4", "zorder": 1000002.0, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data04", "id": "el1178139943936821968"}], "markers": [], "id": "el1178139943937528528", "ydomain": [0.0, 500000.0], "collections": [{"paths": [[[[0.0, -0.5], [0.13260155, -0.5], [0.25978993539242673, -0.44731684579412084], [0.3535533905932738, -0.3535533905932738], [0.44731684579412084, -0.25978993539242673], [0.5, -0.13260155], [0.5, 0.0], [0.5, 0.13260155], [0.44731684579412084, 0.25978993539242673], [0.3535533905932738, 0.3535533905932738], [0.25978993539242673, 0.44731684579412084], [0.13260155, 0.5], [0.0, 0.5], [-0.13260155, 0.5], [-0.25978993539242673, 0.44731684579412084], [-0.3535533905932738, 0.3535533905932738], [-0.44731684579412084, 0.25978993539242673], [-0.5, 0.13260155], [-0.5, 0.0], [-0.5, -0.13260155], [-0.44731684579412084, -0.25978993539242673], [-0.3535533905932738, -0.3535533905932738], [-0.25978993539242673, -0.44731684579412084], [-0.13260155, -0.5], [0.0, -0.5]], ["M", "C", "C", "C", "C", "C", "C", "C", "C", "Z"]]], "edgecolors": ["#0000FF"], "edgewidths": [1.0], "offsets": "data02", "yindex": 1, "id": "el1178139943937117712", "pathtransforms": [[7.607257743127308, 0.0, 0.0, 7.607257743127308, 0.0, 0.0]], "pathcoordinates": "display", "offsetcoordinates": "data", "zorder": 1, "xindex": 0, "alphas": [null], "facecolors": []}, {"paths": [[[[-0.5, -0.5], [0.5, 0.5], [-0.5, 0.5], [0.5, -0.5]], ["M", "L", "M", "L"]]], "edgecolors": ["#1F77B4"], "edgewidths": [1.5], "offsets": "data03", "yindex": 1, "id": "el1178139943936782224", "pathtransforms": [[7.978559231302818, 0.0, 0.0, 7.978559231302818, 0.0, 0.0]], "pathcoordinates": "display", "offsetcoordinates": "data", "zorder": 1, "xindex": 0, "alphas": [null], "facecolors": ["#1F77B4"]}, {"paths": [[[[-0.1629032258064516, -0.14448051948051946], [-0.1596774193548387, -0.14123376623376624], [-0.1629032258064516, -0.14123376623376624], [-0.1596774193548387, -0.14448051948051946]], ["M", "L", "M", "L"]]], "edgecolors": ["#1F77B4"], "edgewidths": [1.5], "offsets": "data05", "yindex": 1, "id": "el1178139943936992016", "pathtransforms": [[7.978559231302818, 0.0, 0.0, 7.978559231302818, 0.0, 0.0]], "pathcoordinates": "axes", "offsetcoordinates": "display", "zorder": 1000001.0, "xindex": 0, "alphas": [null], "facecolors": ["#1F77B4"]}], "xscale": "linear", "bbox": [0.125, 0.10999999999999999, 0.77500000000000002, 0.77000000000000002]}], "height": 400.0, "width": 400.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}, {"voffset": 10, "labels": ["3fghA00", "3tq6B02", "1qrvA00", "3u2bC00", "1cktA00", "3tmmA01", "1l8yA00", "2yqiA00", "2lefA00", "2e6oA00", "1k99A00", "2crjA00", "1v63A00", "2ctoA01", "1wz6A01", "1wgfA01", "2d7lA01"], "hoffset": 0, "location": "mouse", "type": "tooltip", "id": "el1178139943937117712"}, {"labels": [264131, 264132, 264133, 264134, 264135, 264136, 264137, 264138, 264139, 264140, 264141, 264142, 264143, 264144, 264145, 264146, 264147], "type": "helloworld", "id": "el1178139943937117712"}], "data": {"data06": [[0.38897849462365586, 0.827922077922078], [0.9686379928315413, 0.827922077922078], [0.9775985663082437, 0.827922077922078], [0.9775985663082437, 0.8369408369408371], [0.9775985663082437, 0.9684343434343436], [0.9775985663082437, 0.9774531024531026], [0.9686379928315413, 0.9774531024531026], [0.38897849462365586, 0.9774531024531026], [0.38001792114695343, 0.9774531024531026], [0.38001792114695343, 0.9684343434343436], [0.38001792114695343, 0.8369408369408371], [0.38001792114695343, 0.827922077922078], [0.38897849462365586, 0.827922077922078]], "data04": [[0.3979390681003584, 0.9394841269841272], [0.4875448028673835, 0.9394841269841272]], "data05": [[187.24999999999997, 311.20138888888886]], "data02": [[67.0, 60612.0], [82.0, 79543.0], [73.0, 62356.0], [76.0, 72278.0], [71.0, 60816.0], [106.0, 95940.0], [84.0, 78222.0], [81.0, 66863.0], [86.0, 81629.0], [87.0, 74128.0], [91.0, 92426.0], [92.0, 77949.0], [101.0, 92030.0], [61.0, 61399.0], [60.0, 61588.0], [53.0, 50690.0], [53.0, 51994.0]], "data03": [], "data01": [[53.0, 51111.44303646503], [106.0, 95161.39297534217]]}, "id": "el1178139943943765712"}';
function mpld3_load_lib(url, callback){
  var s = document.createElement("script");
  s.src = url;
  s.async = true;
  s.onreadystatechange = s.onload = callback;
  s.onerror = function(){console.warn("failed to load library " + url);};
  document.getElementsByTagName("head")[0].appendChild(s);
};


// var e = $.Event("")
// jquery()
if(typeof(mpld3) !== "undefined" && mpld3._mpld3IsLoaded){
   // already loaded: just create the figure

   !function(mpld3){

      mpld3.register_plugin("helloworld", HelloWorld);
      HelloWorld.prototype = Object.create(mpld3.Plugin.prototype);
      HelloWorld.prototype.constructor = HelloWorld;
      HelloWorld.prototype.requiredProps = ["id","labels","idxs",];
      HelloWorld.prototype.defaultProps = {
                                                  hoffset:0,
                                                  voffset:10};
      function HelloWorld(fig, props){
          mpld3.Plugin.call(this, fig, props);
          // console.dir("fig:")
          // console.dir(fig)
      };
    
    HelloWorld.prototype.draw = function(){
            
        var tooltip = d3.select("body").append("div")
                    .attr("class", "mpld3-tooltip")
                    .style("position", "absolute")
                    .style("z-index", "10")
                    .style("visibility", "hidden");

        var obj = mpld3.get_element(this.props.id);
        var labels = (this.props.labels);
        var idxs = (this.props.idxs);
        var alpha_fg = 1.0
        var alpha_bg = 0.15
        var active = d3.select(null);


        console.dir("obj is")
        obj.elements()
          .attr("id", function(d,i) { return "dbid_"+idxs[i] } )

        function greenish(obj){
        d3.select(obj).transition().duration(50)
                                .style("fill","green")
                                .style("fill-opacity", alpha_fg)    
        }
 
        function bluish(obj){
                d3.select(obj).transition().duration(200)
                  .style("fill", "blue")
                  .style("fill-opacity",alpha_bg);           
        }

        function d3sel(event,adom){
          var path= $("#"+adom)[0]

          // if (active.node() == path) return reset();

          bluish(active.node())
          active.classed("active",false)
          active = d3.select(path).classed("active",true)
          // d3.select(path).classed("active",true)

          console.log("active node becomes", active.node())
          console.log("active node becomes", path)
          greenish(path)
        // d3.select(path)
        console.log(path.attributes)    

          // console.dir(active)

        }

        parent.$(parent.document).on("light",{},d3sel)

        function clicked(d,i){
        parent.$(parent.document).trigger("light",this.id)        
        }


        function reset(){
          bluish(active.node())
          active.classed("active",false)
          active = d3.select(null)
        };


        obj.elements().on("mousedown",function(d,i){
          parent.$(parent.document).trigger("light",this.id)       
        })
          .on("mouseover", function(d, i){
            // console.log
            if (this!==active.node()){
                d3.select(this).transition().duration(50)
                  // .style("opacity", alpha_fg)
                  // .style("color","red")
                    .style("fill","red")
                  
                   tooltip.html("You are hovering over:  "+labels[i])
                         .style("visibility", "visible");
             }
          }
                   )
          .on("mouseout", function(d, i){
            if (this!==active.node()){
              bluish(this)
            }
          })


            var svg = d3.select("#fig_1").select("svg")
            var g = svg.select(".mpld3-axes")
            var paths=g.selectAll("g")


            var bounds = paths.node().getBBox()
            var pbounds =  g.node().getBBox()
            console.dir("this.props.id")
            console.dir(eval("this.props"))
            var width = 400
            var height =400


    }




    mpld3.register_plugin("rect", RectPlugin);
    RectPlugin.prototype = Object.create(mpld3.Plugin.prototype);
    RectPlugin.prototype.constructor = RectPlugin;
    RectPlugin.prototype.requiredProps = ['xlim','ylim'];
    RectPlugin.prototype.defaultProps = {
      // xlim: false,
      // ylim: false,
      button: true,
      enabled: null
    };

    function RectPlugin(fig, props){
      mpld3.Plugin.call(this, fig, props);
      var enabled = this.props.enabled;
      var xlim = this.props.xlim;
      var ylim = this.props.ylim;

      if (this.props.button) {
        var rectButton = mpld3.ButtonFactory({
          buttonID: "rect",
          sticky: false,
          actions: [ "drag" ],
                    // onActivate: this.activate.bind(this),
          onActivate: function(){ 
            var duration = 500
            propagate = false
                      console.dir("fig");
                      console.dir(fig);

                      this.fig.axes.forEach(
                      function(ax) {
                        console.dir('xlim')
                        console.dir(xlim)
                          // this.set_axlim(this.props.xdomain, this.props.ydomain, duration, propagate);
                          if ( xlim &&  ylim){
                          ax.set_axlim( xlim, ylim, duration, propagate);
                          // this.props.xlim
                          }
                          else{
                          ax.set_axlim(ax.props.xdomain, ax.props.ydomain, duration, propagate);
                          console.dir("ax.props.xdomain")
                          console.dir(ax.props)
                          }
                       // ax.reset(duration  , false);
                      })
              // this.deactivate()
              // this.enabled = false
                  },


          // onDeactivate: this.deactivate.bind(this),
          // onDraw: function() {
            // this.setState(enabled);
          // },
          icon: function() {
            // return mpld3.icons["brush"];
            return mpld3.icons["reset"];
          }
        });
        this.fig.buttons.push(rectButton);
      }

      this.extentClass = "rectbrush";
    }

    RectPlugin.prototype.activate = function() {
      if (this.enable) this.enable();
    };
    RectPlugin.prototype.deactivate = function() {
      if (this.disable) this.disable();
    };


    RectPlugin.prototype.draw = function() {
      mpld3.insert_css("#" + this.fig.figid + " rect.extent." + this.extentClass, {
        fill: "#fff",
        "fill-opacity": 0,
        stroke: "#999"
      });

      var brush = this.fig.getBrush();
      this.enable = function() {
        this.fig.showBrush(this.extentClass);
        brush.on("brushend", brushend.bind(this));
        this.enabled = true;
      };
      this.disable = function() {
        this.fig.hideBrush(this.extentClass);
        this.enabled = false;
      };
      this.toggle = function() {
        this.enabled ? this.disable() : this.enable();
      };
      function brushend(d) {
        if (this.enabled) {
          var extent = brush.extent();
          if (!brush.empty()) {
          }
        } else {
          d.axes.call(brush.clear());
        }
      }
      this.disable();
    };

    // var fig_json1 = JSON.parse(fig_json2)
    {% autoescape off %}

    var fig_json1 = JSON.parse('{{fig_json1}}')
    // var fig_json1 = `{{fig_json1}}`;
    {% endautoescape %}
    if (fig_json1.success){
       try{ mpld3.draw_figure("fig_1", fig_json1)}
       catch(err){
        console.error(err)
         console.dir(fig_json1)
         console.log(fig_json1)

         // print(fig_json1);
         // document.getElementById('fig_1').innerHTML=fig_json1;
       };
     }else{
      function addslashes(string) {
    return string.replace(/\\/g, '\\\\').
        replace(/\u0008/g, '\\b').
        replace(/\t/g, '\\t').
        replace(/\n/g, '\\n').
        replace(/\f/g, '\\f').
        replace(/\r/g, '\\r').
        // replace(/'/g, '\\\'').
        replace(/</g, '\\\'').
        replace(/>/g, '\\\'').
        replace(/"/g, '\\"');

}
      document.getElementById("fig_1").innerHTML = addslashes(fig_json1.errmsg)
      // document.getElementById("fig_1").innerHTML = JSON.stringify(String(fig_json1.errmsg));
     };

   }(mpld3);
   
};
</script></body></html>